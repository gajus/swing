{"version":3,"sources":["card.js"],"names":[],"mappings":"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","file":"card.js","sourcesContent":["import Sister from 'sister';\r\nimport Hammer from 'hammerjs';\r\nimport rebound from 'rebound';\r\nimport vendorPrefix from 'vendor-prefix';\r\nimport util from './util.js';\r\nimport raf from 'raf';\r\n\r\nlet Card;\r\n\r\n/**\r\n * @param {Stack} stack\r\n * @param {HTMLElement} targetElement\r\n * @return {Object} An instance of Card.\r\n */\r\nCard = (stack, targetElement) => {\r\n    let card,\r\n        config,\r\n        construct,\r\n        currentX,\r\n        currentY,\r\n        doMove,\r\n        eventEmitter,\r\n        isDraging,\r\n        lastThrow,\r\n        lastTranslate,\r\n        lastX,\r\n        lastY,\r\n        mc,\r\n        onSpringUpdate,\r\n        springSystem,\r\n        springThrowIn,\r\n        springThrowOut,\r\n        throwOutDistance,\r\n        throwWhere;\r\n\r\n    construct = () => {\r\n        card = {};\r\n        config = Card.makeConfig(stack.getConfig());\r\n        eventEmitter = Sister();\r\n        springSystem = stack.getSpringSystem();\r\n        springThrowIn = springSystem.createSpring(250, 10);\r\n        springThrowOut = springSystem.createSpring(500, 20);\r\n        lastThrow = {};\r\n        lastTranslate = {\r\n            x: 0,\r\n            y: 0\r\n        };\r\n\r\n        springThrowIn.setRestSpeedThreshold(0.05);\r\n        springThrowIn.setRestDisplacementThreshold(0.05);\r\n\r\n        springThrowOut.setRestSpeedThreshold(0.05);\r\n        springThrowOut.setRestDisplacementThreshold(0.05);\r\n\r\n        throwOutDistance = config.throwOutDistance(config.minThrowOutDistance, config.maxThrowOutDistance);\r\n\r\n        mc = new Hammer.Manager(targetElement, {\r\n            recognizers: [\r\n                [\r\n                    Hammer.Pan,\r\n                    {\r\n                        threshold: 2\r\n                    }\r\n                ]\r\n            ]\r\n        });\r\n\r\n        Card.appendToParent(targetElement);\r\n\r\n        eventEmitter.on('panstart', () => {\r\n            Card.appendToParent(targetElement);\r\n\r\n            eventEmitter.trigger('dragstart', {\r\n                target: targetElement\r\n            });\r\n\r\n            currentX = 0;\r\n            currentY = 0;\r\n\r\n            isDraging = true;\r\n\r\n            (function animation () {\r\n                if (isDraging) {\r\n                    doMove();\r\n\r\n                    raf(animation);\r\n                }\r\n            })();\r\n        });\r\n\r\n        eventEmitter.on('panmove', (e) => {\r\n            currentX = e.deltaX;\r\n            currentY = e.deltaY;\r\n        });\r\n\r\n        eventEmitter.on('panend', (e) => {\r\n            let x,\r\n                y;\r\n\r\n            isDraging = false;\r\n\r\n            x = lastTranslate.x + e.deltaX;\r\n            y = lastTranslate.y + e.deltaY;\r\n\r\n            if (config.isThrowOut(x, targetElement, config.throwOutConfidence(x, targetElement))) {\r\n                card.throwOut(x, y);\r\n            } else {\r\n                card.throwIn(x, y);\r\n            }\r\n\r\n            eventEmitter.trigger('dragend', {\r\n                target: targetElement\r\n            });\r\n        });\r\n\r\n        mc.on('panstart', (e) => {\r\n            eventEmitter.trigger('panstart', e);\r\n        });\r\n\r\n        mc.on('panmove', (e) => {\r\n            eventEmitter.trigger('panmove', e);\r\n        });\r\n\r\n        mc.on('panend', (e) => {\r\n            eventEmitter.trigger('panend', e);\r\n        });\r\n\r\n        springThrowIn.addListener({\r\n            onSpringUpdate: (spring) => {\r\n                let value,\r\n                    x,\r\n                    y;\r\n\r\n                value = spring.getCurrentValue();\r\n                x = rebound.MathUtil.mapValueInRange(value, 0, 1, lastThrow.fromX, 0);\r\n                y = rebound.MathUtil.mapValueInRange(value, 0, 1, lastThrow.fromY, 0);\r\n\r\n                onSpringUpdate(x, y);\r\n            },\r\n            onSpringAtRest: () => {\r\n                eventEmitter.trigger('throwinend', {\r\n                    target: targetElement\r\n                });\r\n            }\r\n        });\r\n\r\n        springThrowOut.addListener({\r\n            onSpringUpdate: (spring) => {\r\n                let value,\r\n                    x,\r\n                    y;\r\n\r\n                value = spring.getCurrentValue();\r\n                x = rebound.MathUtil.mapValueInRange(value, 0, 1, lastThrow.fromX, throwOutDistance * lastThrow.direction);\r\n                y = lastThrow.fromY;\r\n\r\n                onSpringUpdate(x, y);\r\n            },\r\n            onSpringAtRest: () => {\r\n                eventEmitter.trigger('throwoutend', {\r\n                    target: targetElement\r\n                });\r\n            }\r\n        });\r\n\r\n        /**\r\n         * Transforms card position based on the current environment variables.\r\n         *\r\n         * @return {undefined}\r\n         */\r\n        doMove = () => {\r\n            let r,\r\n                x,\r\n                y;\r\n\r\n            if (currentX === lastX && currentY === lastY) {\r\n                return;\r\n            }\r\n\r\n            lastX = currentX;\r\n            lastY = currentY;\r\n\r\n            x = lastTranslate.x + currentX;\r\n            y = lastTranslate.y + currentY;\r\n            r = config.rotation(x, y, targetElement, config.maxRotation);\r\n\r\n            config.transform(targetElement, x, y, r);\r\n\r\n            eventEmitter.trigger('dragmove', {\r\n                target: targetElement,\r\n                throwOutConfidence: config.throwOutConfidence(x, targetElement),\r\n                throwDirection: x < 0 ? Card.DIRECTION_LEFT : Card.DIRECTION_RIGHT\r\n            });\r\n        };\r\n\r\n        /**\r\n         * Invoked every time the physics solver updates the Spring's value.\r\n         *\r\n         * @param {Number} x\r\n         * @param {Number} y\r\n         * @return {undefined}\r\n         */\r\n        onSpringUpdate = (x, y) => {\r\n            let r;\r\n\r\n            r = config.rotation(x, y, targetElement, config.maxRotation);\r\n\r\n            lastTranslate.x = x || 0;\r\n            lastTranslate.y = y || 0;\r\n\r\n            Card.transform(targetElement, x, y, r);\r\n        };\r\n\r\n        /**\r\n         * @param {Card.THROW_IN|Card.THROW_OUT} where\r\n         * @param {Number} fromX\r\n         * @param {Number} fromY\r\n         * @return {undefined}\r\n         */\r\n        throwWhere = (where, fromX, fromY) => {\r\n            lastThrow.fromX = fromX;\r\n            lastThrow.fromY = fromY;\r\n            lastThrow.direction = lastThrow.fromX < 0 ? Card.DIRECTION_LEFT : Card.DIRECTION_RIGHT;\r\n\r\n            if (where === Card.THROW_IN) {\r\n                springThrowIn.setCurrentValue(0).setAtRest().setEndValue(1);\r\n\r\n                eventEmitter.trigger('throwin', {\r\n                    target: targetElement,\r\n                    throwDirection: lastThrow.direction\r\n                });\r\n            } else if (where === Card.THROW_OUT) {\r\n                springThrowOut.setCurrentValue(0).setAtRest().setVelocity(100).setEndValue(1);\r\n\r\n                eventEmitter.trigger('throwout', {\r\n                    target: targetElement,\r\n                    throwDirection: lastThrow.direction\r\n                });\r\n\r\n                if (lastThrow.direction === Card.DIRECTION_LEFT) {\r\n                    eventEmitter.trigger('throwoutleft', {\r\n                        target: targetElement,\r\n                        throwDirection: lastThrow.direction\r\n                    });\r\n                } else {\r\n                    eventEmitter.trigger('throwoutright', {\r\n                        target: targetElement,\r\n                        throwDirection: lastThrow.direction\r\n                    });\r\n                }\r\n            } else {\r\n                throw new Error('Invalid throw event.');\r\n            }\r\n        };\r\n    };\r\n\r\n    construct();\r\n\r\n    /**\r\n     * Alias\r\n     */\r\n    card.on = eventEmitter.on;\r\n    card.trigger = eventEmitter.trigger;\r\n\r\n    /**\r\n     * Throws a card into the stack from an arbitrary position.\r\n     *\r\n     * @param {Number} fromX\r\n     * @param {Number} fromY\r\n     * @return {undefined}\r\n     */\r\n    card.throwIn = (fromX, fromY) => {\r\n        throwWhere(Card.THROW_IN, fromX, fromY);\r\n    };\r\n\r\n    /**\r\n     * Throws a card out of the stack in the direction away from the original offset.\r\n     *\r\n     * @param {Number} fromX\r\n     * @param {Number} fromY\r\n     * @return {undefined}\r\n     */\r\n    card.throwOut = (fromX, fromY) => {\r\n        throwWhere(Card.THROW_OUT, fromX, fromY);\r\n    };\r\n\r\n    /**\r\n     * Unbinds all Hammer.Manager events.\r\n     * Removes the listeners from the physics simulation.\r\n     *\r\n     * @return {undefined}\r\n     */\r\n    card.destroy = () => {\r\n        mc.destroy();\r\n        springThrowIn.destroy();\r\n        springThrowOut.destroy();\r\n\r\n        stack.destroyCard(card);\r\n    };\r\n\r\n    return card;\r\n};\r\n\r\n/**\r\n * Creates a configuration object.\r\n *\r\n * @param {Object} config\r\n * @return {Object}\r\n */\r\nCard.makeConfig = (config = {}) => {\r\n    let defaultConfig;\r\n\r\n    defaultConfig = {\r\n        isThrowOut: Card.isThrowOut,\r\n        throwOutConfidence: Card.throwOutConfidence,\r\n        throwOutDistance: Card.throwOutDistance,\r\n        minThrowOutDistance: 400,\r\n        maxThrowOutDistance: 500,\r\n        rotation: Card.rotation,\r\n        maxRotation: 20,\r\n        transform: Card.transform\r\n    };\r\n\r\n    return util.assign({}, defaultConfig, config);\r\n};\r\n\r\n/**\r\n * Uses CSS transform to translate element position and rotation.\r\n *\r\n * Invoked in the event of `dragmove` and every time the physics solver is triggered.\r\n *\r\n * @param {HTMLElement} element\r\n * @param {Number} x Horizontal offset from the startDrag.\r\n * @param {Number} y Vertical offset from the startDrag.\r\n * @param {Number} r\r\n * @return {undefined}\r\n */\r\nCard.transform = (element, x, y, r) => {\r\n    element.style[vendorPrefix('transform')] = `translate3d(0, 0, 0) translate(${x}px, ${y}px) rotate(${r}deg)`;\r\n};\r\n\r\n/**\r\n * Append element to the parentNode.\r\n *\r\n * This makes the element first among the siblings. The reason for using\r\n * this as opposed to zIndex is to allow CSS selector :nth-child.\r\n *\r\n * Invoked in the event of mousedown.\r\n * Invoked when card is added to the stack.\r\n *\r\n * @param {HTMLElement} element The target element.\r\n * @return {undefined}\r\n */\r\nCard.appendToParent = (element) => {\r\n    let parentNode,\r\n        siblings,\r\n        targetIndex;\r\n\r\n    parentNode = element.parentNode;\r\n    siblings = util.elementChildren(parentNode);\r\n    targetIndex = siblings.indexOf(element);\r\n\r\n    if (targetIndex + 1 !== siblings.length) {\r\n        parentNode.removeChild(element);\r\n        parentNode.appendChild(element);\r\n    }\r\n};\r\n\r\n/**\r\n * Returns a value between 0 and 1 indicating the completeness of the throw out condition.\r\n *\r\n * Ration of the absolute distance from the original card position and element width.\r\n *\r\n * @param {Number} offset Distance from the dragStart.\r\n * @param {HTMLElement} element Element.\r\n * @return {Number}\r\n */\r\nCard.throwOutConfidence = (offset, element) => {\r\n    return Math.min(Math.abs(offset) / element.offsetWidth, 1);\r\n};\r\n\r\n/**\r\n * Determines if element is being thrown out of the stack.\r\n *\r\n * Element is considered to be thrown out when throwOutConfidence is equal to 1.\r\n *\r\n * @param {Number} offset Distance from the dragStart.\r\n * @param {HTMLElement} element Element.\r\n * @param {Number} throwOutConfidence config.throwOutConfidence\r\n * @return {Boolean}\r\n */\r\nCard.isThrowOut = (offset, element, throwOutConfidence) => {\r\n    return throwOutConfidence === 1;\r\n};\r\n\r\n/**\r\n * Calculates a distances at which the card is thrown out of the stack.\r\n *\r\n * @param {Number} min\r\n * @param {Number} max\r\n * @return {Number}\r\n */\r\nCard.throwOutDistance = (min, max) => {\r\n    return util.random(min, max);\r\n};\r\n\r\n/**\r\n * Calculates rotation based on the element x and y offset, element width and maxRotation variables.\r\n *\r\n * @param {Number} x Horizontal offset from the startDrag.\r\n * @param {Number} y Vertical offset from the startDrag.\r\n * @param {HTMLElement} element Element.\r\n * @param {Number} maxRotation\r\n * @return {Number} Rotation angle expressed in degrees.\r\n */\r\nCard.rotation = (x, y, element, maxRotation) => {\r\n    let horizontalOffset,\r\n        rotation,\r\n        verticalOffset;\r\n\r\n    horizontalOffset = Math.min(Math.max(x / element.offsetWidth, -1), 1);\r\n    verticalOffset = (y > 0 ? 1 : -1) * Math.min(Math.abs(y) / 100, 1);\r\n    rotation = horizontalOffset * verticalOffset * maxRotation;\r\n\r\n    return rotation;\r\n};\r\n\r\nCard.DIRECTION_LEFT = -1;\r\nCard.DIRECTION_RIGHT = 1;\r\n\r\nCard.THROW_IN = 'in';\r\nCard.THROW_OUT = 'out';\r\n\r\nexport default Card;\r\n"],"sourceRoot":"/source/"}